{
    "document_type": "online_article",
    "title": "Forecasting: Principles and Practice (3rd ed)",
    "author": "Rob J Hyndman, George Athanasopoulos",
    "source": "https://otexts.com/fpp3/least-squares.html",
    "date_published": "23 March 2025",
    "flag": "",
    "text": "In practice, of course, we have a collection of observations but we do not know the values of the coefficients\\(\\beta_0,\\beta_1, \\dots, \\beta_k\\). These need to be estimated from the data. The least squares principle provides a way of choosing the coefficients effectively by minimising the sum of the squared errors. That is, we choose the values of\\(\\beta_0, \\beta_1, \\dots, \\beta_k\\)that minimise\\[\n  \\sum_{t=1}^T \\varepsilon_t^2 = \\sum_{t=1}^T (y_t -\n  \\beta_{0} - \\beta_{1} x_{1,t} - \\beta_{2} x_{2,t} - \\cdots - \\beta_{k} x_{k,t})^2.\n\\] This is calledleast squaresestimation because it gives the least value for the sum of squared errors. Finding the best estimates of the coefficients is often called âfittingâ the model to the data, or sometimes âlearningâ or âtrainingâ the model. The line shown in Figure7.3was obtained in this way. When we refer to theestimatedcoefficients, we will use the notation\\(\\hat\\beta_0, \\dots, \\hat\\beta_k\\). The equations for these will be given in Section7.9. TheTSLM()function fits a linear regression model to time series data. It is similar to thelm()function which is widely used for linear models, butTSLM()provides additional facilities for handling time series. A multiple linear regression model for US consumption is\\[\ny_t=\\beta_0 + \\beta_1 x_{1,t}+ \\beta_2 x_{2,t}+ \\beta_3 x_{3,t}+ \\beta_4 x_{4,t}+\\varepsilon_t,\n\\]where\\(y\\)is the percentage change in real personal consumption expenditure,\\(x_1\\)is the percentage change in real personal disposable income,\\(x_2\\)is the percentage change in industrial production,\\(x_3\\)is the percentage change in personal savings and\\(x_4\\)is the change in the unemployment rate. The following output provides information about the fitted model. The first column ofCoefficientsgives an estimate of each\\(\\beta\\)coefficient and the second column gives its standard error (i.e., the standard deviation which would be obtained from repeatedly estimating the\\(\\beta\\)coefficients on similar data sets). The standard error gives a measure of the uncertainty in the estimated\\(\\beta\\)coefficient. For forecasting purposes, the final two columns are of limited interest. The ât valueâ is the ratio of an estimated\\(\\beta\\)coefficient to its standard error and the last column gives the p-value: the probability of the estimated\\(\\beta\\)coefficient being as large as it is if there was no real relationship between consumption and the corresponding predictor. This is useful when studying the effect of each predictor, but is not particularly useful for forecasting. Predictions of\\(y\\)can be obtained by using the estimated coefficients in the regression equation and setting the error term to zero. In general we write,\\[\\begin{equation}\n  \\hat{y}_t = \\hat\\beta_{0} + \\hat\\beta_{1} x_{1,t} + \\hat\\beta_{2} x_{2,t} + \\cdots + \\hat\\beta_{k} x_{k,t}.\n  \\tag{7.2}\n\\end{equation}\\]Plugging in the values of\\(x_{1,t},\\dots,x_{k,t}\\)for\\(t=1,\\dots,T\\)returns predictions of\\(y_t\\)within the training set, referred to asfitted values. Note that these are predictions of the data used to estimate the model, not genuine forecasts of future values of\\(y\\). The following plots show the actual values compared to the fitted values for the percentage change in the US consumption expenditure series. The time plot in Figure7.6shows that the fitted values follow the actual data fairly closely. This is verified by the strong positive relationship shown by the scatterplot in Figure7.7. Figure 7.6: Time plot of actual US consumption expenditure and predicted US consumption expenditure. Figure 7.7: Actual US consumption expenditure plotted against predicted US consumption expenditure. A common way to summarise how well a linear regression model fits the data is via the coefficient of determination, or\\(R^2\\). This can be calculated as the square of the correlation between the observed\\(y\\)values and the predicted\\(\\hat{y}\\)values. Alternatively, it can also be calculated as,\\[\n  R^2 = \\frac{\\sum(\\hat{y}_{t} - \\bar{y})^2}{\\sum(y_{t}-\\bar{y})^2},\n\\]where the summations are over all observations. Thus, it reflects the proportion of variation in the forecast variable that is accounted for (or explained) by the regression model. In simple linear regression, the value of\\(R^2\\)is also equal to the square of the correlation between\\(y\\)and\\(x\\)(provided an intercept has been included). If the predictions are close to the actual values, we would expect\\(R^2\\)to be close to 1. On the other hand, if the predictions are unrelated to the actual values, then\\(R^2=0\\)(again, assuming there is an intercept). In all cases,\\(R^2\\)lies between 0 and 1. The\\(R^2\\)value is used frequently, though often incorrectly, in forecasting. The value of\\(R^2\\)will never decrease when adding an extra predictor to the model and this can lead to over-fitting. There are no set rules for what is a good\\(R^2\\)value, and typical values of\\(R^2\\)depend on the type of data used. Validating a modelâs forecasting performance on the test data is much better than measuring the\\(R^2\\)value on the training data. Figure7.7plots the actual consumption expenditure values versus the fitted values. The correlation between these variables is\\(r=0.877\\)hence\\(R^2= 0.768\\)(shown in the output above). In this case, the model does an excellent job as it explains 76.8% of the variation in the consumption data. Compare that to the\\(R^2\\)value of 0.15 obtained from the simple regression with the same data set in Section7.1. Adding the three extra predictors has allowed a lot more of the variation in the consumption data to be explained. Another measure of how well the model has fitted the data is the standard deviation of the residuals, which is often known as the âresidual standard errorâ. This is shown in the above output with the value 0.31. It is calculated using\\[\\begin{equation}\n  \\hat{\\sigma}_e=\\sqrt{\\frac{1}{T-k-1}\\sum_{t=1}^{T}{e_t^2}},\n  \\tag{7.3}\n\\end{equation}\\]where\\(k\\)is the number of predictors in the model. Notice that we divide by\\(T-k-1\\)because we have estimated\\(k+1\\)parameters (the intercept and a coefficient for each predictor variable) in computing the residuals. The standard error is related to the size of the average error that the model produces. We can compare this error to the sample mean of\\(y\\)or with the standard deviation of\\(y\\)to gain some perspective on the accuracy of the model. The standard error will be used when generating prediction intervals, discussed in Section7.6."
}